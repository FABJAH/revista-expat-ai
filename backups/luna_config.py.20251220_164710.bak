"""
Configuraci√≥n de Luna - Bot de Publicidad
Archivo centralizado para f√°cil personalizaci√≥n
"""

import json
from pathlib import Path
from typing import Dict, List, Optional

# ============================================================================
# CONFIGURACI√ìN DE MASCOTA
# ============================================================================

MASCOT_CONFIG = {
    "name": "Luna",
    "emoji": "ü¶â",
    "description": "Un simp√°tico b√∫ho con grandes ojos curiosos",
    "color_primary": "#FF6B6B",
    "color_secondary": "#FB5607",
    "personality": "Amigable, curioso, motivador",
    "animation_speed": "normal"  # "slow", "normal", "fast"
}

# ============================================================================
# CONFIGURACI√ìN DE PLANES
# ============================================================================

PLANS_CONFIG = {
    "es": [
        {
            "id": "directorio_mensual",
            "nombre": "Directorio - Mensual",
            "emoji": "üìç",
            "precio": 34,
            "moneda": "‚Ç¨",
            "periodo": "mes",
            "descripcion_corta": "Aparece en nuestro directorio",
            "beneficios": [
                "‚úÖ Listing en directorio digital",
                "‚úÖ Perfil completo (foto, descripci√≥n, contacto)",
                "‚úÖ Categor√≠as sin l√≠mite",
                "‚úÖ Visible para 12,000+ usuarios/mes",
                "‚úÖ Analytics de visitas y clics",
                "‚úÖ Soporte por email",
                "‚úÖ Actualizaci√≥n ilimitada de perfil"
            ],
            "limite_categorias": 999,
            "limite_fotos": 5,
            "analytics": True,
            "featured": False,
            "ideal_para": "Todos los negocios",
            "cta": "Contratar mensualmente",
            "popular": False
        },
        {
            "id": "directorio_anual",
            "nombre": "Directorio - Anual (10% Descuento)",
            "emoji": "üéÅ",
            "precio": 367.2,
            "precio_original": 408,
            "moneda": "‚Ç¨",
            "periodo": "a√±o",
            "descripcion_corta": "Contrata por un a√±o y ahorra",
            "beneficios": [
                "‚úÖ TODO lo del plan mensual",
                "‚úÖ 10% DESCUENTO (34‚Ç¨ x 12 = 408‚Ç¨ ‚Üí 367.2‚Ç¨/a√±o)",
                "‚úÖ Visibilidad garantizada todo el a√±o",
                "‚úÖ 1 sesi√≥n de asesoramiento estrat√©gico GRATIS",
                "‚úÖ Soporte prioritario",
                "‚úÖ Newsletter semanal exclusiva",
                "‚úÖ Acceso a eventos de la revista"
            ],
            "limite_categorias": 999,
            "limite_fotos": 5,
            "analytics": True,
            "featured": False,
            "ahorro_porcentaje": 10,
            "ideal_para": "Compromisos a largo plazo",
            "cta": "Contratar anualmente (10% OFF)",
            "popular": True
        },
        {
            "id": "campana_especial",
            "nombre": "Campa√±as Especiales",
            "emoji": "üöÄ",
            "precio": "Personalizado",
            "moneda": "‚Ç¨",
            "periodo": "variable",
            "descripcion_corta": "Impulsa tu negocio con una campa√±a",
            "beneficios": [
                "‚úÖ Trato PREFERENTE con revista",
                "‚úÖ Precios especiales negociables",
                "‚úÖ Acompa√±amiento profesional",
                "‚úÖ Estrategia personalizada para impacto",
                "‚úÖ Visibilidad aumentada en el directorio",
                "‚úÖ Newsletter promocional dedicada",
                "‚úÖ Soporte VIP durante la campa√±a",
                "‚úÖ An√°lisis y reporte de resultados"
            ],
            "limite_categorias": 999,
            "limite_fotos": 10,
            "analytics": True,
            "featured": True,
            "campana": True,
            "ideal_para": "Negocios que quieren crecer r√°pido",
            "cta": "Solicitar campa√±a personalizada",
            "popular": False,
            "nota": "Disponible para clientes anuales o bajo consulta"
        }
    ],
    "en": [
        {
            "id": "directorio_mensual",
            "nombre": "Directory - Monthly",
            "emoji": "üìç",
            "precio": 34,
            "moneda": "‚Ç¨",
            "periodo": "month",
            "descripcion_corta": "Appear in our directory",
            "beneficios": [
                "‚úÖ Digital directory listing",
                "‚úÖ Complete profile (photo, description, contact)",
                "‚úÖ Unlimited categories",
                "‚úÖ Visible to 12,000+ users/month",
                "‚úÖ Analytics of visits and clicks",
                "‚úÖ Email support",
                "‚úÖ Unlimited profile updates"
            ],
            "limite_categorias": 999,
            "limite_fotos": 5,
            "analytics": True,
            "featured": False,
            "ideal_para": "All businesses",
            "cta": "Subscribe monthly",
            "popular": False
        },
        {
            "id": "directorio_anual",
            "nombre": "Directory - Annual (10% Discount)",
            "emoji": "üéÅ",
            "precio": 367.2,
            "precio_original": 408,
            "moneda": "‚Ç¨",
            "periodo": "year",
            "descripcion_corta": "Annual subscription with savings",
            "beneficios": [
                "‚úÖ EVERYTHING from monthly plan",
                "‚úÖ 10% DISCOUNT (34‚Ç¨ x 12 = 408‚Ç¨ ‚Üí 367.2‚Ç¨/year)",
                "‚úÖ Guaranteed visibility all year",
                "‚úÖ 1 FREE strategic consultation session",
                "‚úÖ Priority support",
                "‚úÖ Exclusive weekly newsletter",
                "‚úÖ Access to magazine events"
            ],
            "limite_categorias": 999,
            "limite_fotos": 5,
            "analytics": True,
            "featured": False,
            "ahorro_porcentaje": 10,
            "ideal_para": "Long-term commitments",
            "cta": "Subscribe annually (10% OFF)",
            "popular": True
        },
        {
            "id": "campana_especial",
            "nombre": "Special Campaigns",
            "emoji": "üöÄ",
            "precio": "Custom",
            "moneda": "‚Ç¨",
            "periodo": "variable",
            "descripcion_corta": "Boost your business with a campaign",
            "beneficios": [
                "‚úÖ PREFERRED treatment with magazine",
                "‚úÖ Special negotiable pricing",
                "‚úÖ Professional support & guidance",
                "‚úÖ Personalized strategy for impact",
                "‚úÖ Increased visibility in directory",
                "‚úÖ Dedicated promotional newsletter",
                "‚úÖ VIP support during campaign",
                "‚úÖ Results analysis and report"
            ],
            "limite_categorias": 999,
            "limite_fotos": 10,
            "analytics": True,
            "featured": True,
            "campana": True,
            "ideal_para": "Businesses wanting rapid growth",
            "cta": "Request custom campaign",
            "popular": False,
            "nota": "Available for annual customers or upon consultation"
        }
    ]
}

# ============================================================================
# MENSAJES DIN√ÅMICOS
# ============================================================================

DYNAMIC_MESSAGES = {
    "es": {
        # Saludos por hora
        "greeting": {
            "morning": "¬°Hola! üëã ¬øEs tu primer d√≠a en Barcelona? Tengo recursos que necesitas.",
            "afternoon": "¬°Hey! üåü ¬øBuscas servicios en Barcelona? Puedo ayudarte.",
            "evening": "¬°Buenas noches! üåô ¬øNecesitas algo urgente? Estoy aqu√≠."
        },

        # Preguntas proactivas
        "proactive_questions": [
            "¬øEres una empresa? üíº Nos encantar√≠a que te unas a nuestro directorio.",
            "¬øQuieres aumentar tu visibilidad? üìà Mira nuestros planes de publicidad.",
            "üòä Otros negocios como el tuyo han crecido con nosotros. ¬øTe interesa saber c√≥mo?",
            "‚è∞ Oferta especial: 20% OFF en planes anuales (solo esta semana)",
            "¬øNecesitas m√°s clientes? üéØ Te mostramos c√≥mo otros lo logran."
        ],

        # Mensajes de venta
        "sales": {
            "intro": "Nos encantar√≠a ayudarte a vender tus espacios publicitarios. ¬øPor d√≥nde empezamos?",
            "benefits": "Nuestro directorio tiene {count} usuarios activos cada mes. ¬øTe interesa saber m√°s?",
            "urgency": "Muchas empresas se est√°n uniendo esta semana. ¬øQuieres ser uno de ellos?"
        }
    },
    "en": {
        "greeting": {
            "morning": "Hello! üëã Is this your first day in Barcelona? I have resources you need.",
            "afternoon": "Hey! üåü Looking for services in Barcelona? I can help.",
            "evening": "Good evening! üåô Need something urgent? I'm here."
        },
        "proactive_questions": [
            "Are you a business? üíº We'd love to have you in our directory.",
            "Want to increase your visibility? üìà Check out our advertising plans.",
            "üòä Other businesses like yours have grown with us. Interested in learning how?",
            "‚è∞ Special offer: 20% OFF annual plans (this week only)",
            "Need more customers? üéØ Let's show you how others are doing it."
        ],
        "sales": {
            "intro": "We'd love to help you sell your advertising spaces. Where shall we start?",
            "benefits": "Our directory has {count} active users every month. Want to know more?",
            "urgency": "Many businesses are joining this week. Want to be one of them?"
        }
    }
}

# ============================================================================
# CONFIGURACI√ìN DEL WIDGET
# ============================================================================

WIDGET_CONFIG = {
    "position": "bottom-right",  # "bottom-right", "bottom-left", "top-right", "top-left"
    "auto_open": True,
    "auto_open_delay": 3000,  # ms
    "auto_message_interval": 30000,  # ms entre burbujas
    "animation_duration": 300,  # ms
    "chat_width": 420,  # px
    "chat_height": 600,  # px
    "show_notification_badge": True,
    "notification_badge_pulse": True,
    "responsive": True,
    "mobile_full_screen": True,
    "theme": "light"  # "light", "dark", "auto"
}

# ============================================================================
# CATEGOR√çAS DISPONIBLES
# ============================================================================

CATEGORIES = {
    "es": [
        {"id": "legal", "nombre": "Abogados & Legal", "emoji": "‚öñÔ∏è"},
        {"id": "healthcare", "nombre": "M√©dicos & Salud", "emoji": "üè•"},
        {"id": "accommodation", "nombre": "Alojamiento", "emoji": "üè†"},
        {"id": "education", "nombre": "Educaci√≥n & Idiomas", "emoji": "üìö"},
        {"id": "restaurants", "nombre": "Restaurantes & Bares", "emoji": "üçΩÔ∏è"},
        {"id": "services", "nombre": "Servicios", "emoji": "üîß"},
        {"id": "retail", "nombre": "Tiendas", "emoji": "üõçÔ∏è"},
        {"id": "entertainment", "nombre": "Entretenimiento", "emoji": "üé≠"},
        {"id": "sports", "nombre": "Deporte & Fitness", "emoji": "‚öΩ"},
        {"id": "work", "nombre": "Empleo & Trabajo", "emoji": "üíº"},
    ],
    "en": [
        {"id": "legal", "nombre": "Lawyers & Legal", "emoji": "‚öñÔ∏è"},
        {"id": "healthcare", "nombre": "Doctors & Health", "emoji": "üè•"},
        {"id": "accommodation", "nombre": "Accommodation", "emoji": "üè†"},
        {"id": "education", "nombre": "Education & Languages", "emoji": "üìö"},
        {"id": "restaurants", "nombre": "Restaurants & Bars", "emoji": "üçΩÔ∏è"},
        {"id": "services", "nombre": "Services", "emoji": "üîß"},
        {"id": "retail", "nombre": "Shops", "emoji": "üõçÔ∏è"},
        {"id": "entertainment", "nombre": "Entertainment", "emoji": "üé≠"},
        {"id": "sports", "nombre": "Sports & Fitness", "emoji": "‚öΩ"},
        {"id": "work", "nombre": "Jobs & Work", "emoji": "üíº"},
    ]
}

# ============================================================================
# TESTIMONIOS
# ============================================================================

TESTIMONIALS = {
    "es": [
        {
            "nombre": "Juan L√≥pez",
            "negocio": "Abogado - Especialista en NIE",
            "plan": "Plan Premium",
            "testimonial": "En 3 meses triplicamos nuestras consultas. Recomendado 100%.",
            "rating": 5
        },
        {
            "nombre": "Marta Garc√≠a",
            "negocio": "Cl√≠nica Dental",
            "plan": "Plan Featured",
            "testimonial": "Los analytics nos muestran exactamente d√≥nde vienen nuestros pacientes. Incre√≠ble ROI.",
            "rating": 5
        },
        {
            "nombre": "Carlos M√ºller",
            "negocio": "Academia de Idiomas",
            "plan": "Plan Anual",
            "testimonial": "30% de ahorro con el plan anual y 40% m√°s estudiantes. La mejor inversi√≥n.",
            "rating": 5
        }
    ],
    "en": [
        {
            "nombre": "John Smith",
            "negocio": "Lawyer - NIE Specialist",
            "plan": "Premium Plan",
            "testimonial": "Tripled our consultations in 3 months. Highly recommended.",
            "rating": 5
        },
        {
            "nombre": "Sarah Miller",
            "negocio": "Dental Clinic",
            "plan": "Featured Plan",
            "testimonial": "Analytics show us exactly where our patients come from. Incredible ROI.",
            "rating": 5
        },
        {
            "nombre": "Miguel P√©rez",
            "negocio": "Language Academy",
            "plan": "Annual Plan",
            "testimonial": "30% savings with annual plan and 40% more students. Best investment ever.",
            "rating": 5
        }
    ]
}

# ============================================================================
# M√âTRICAS Y ESTAD√çSTICAS
# ============================================================================

PLATFORM_METRICS = {
    "es": {
        "total_users": 12000,
        "monthly_active": 8500,
        "engagement_rate": "87%",
        "avg_session_time": "15 minutos",
        "featured_businesses": 280,
        "categories": 10,
        "testimonials_count": 45,
        "years_in_market": "28 a√±os (desde 1996)",
        "success_stories": [
            "3x m√°s consultas en promedio",
            "45% aumento de clientes",
            "ROI positivo en 45 d√≠as",
            "Audiencia de expatriados consolidada"
        ]
    },
    "en": {
        "total_users": 12000,
        "monthly_active": 8500,
        "engagement_rate": "87%",
        "avg_session_time": "15 minutes",
        "featured_businesses": 280,
        "categories": 10,
        "testimonials_count": 45,
        "years_in_market": "28 years (since 1996)",
        "success_stories": [
            "3x more consultations on average",
            "45% increase in customers",
            "Positive ROI in 45 days",
            "Established expat audience"
        ]
    }
}

# ============================================================================
# FAQ
# ============================================================================

FAQ = {
    "es": [
        {
            "id": "precio",
            "pregunta": "¬øCu√°l es el precio?",
            "keywords": ["precio", "costo", "cuanto"],
            "respuesta": "Nuestros precios var√≠an desde 19‚Ç¨/mes (Plan B√°sico) hasta 199‚Ç¨/a√±o (Directorio Anual). Todos incluyen garant√≠a de satisfacci√≥n.",
            "planes_sugeridos": ["basico", "premium"]
        },
        {
            "id": "beneficios",
            "pregunta": "¬øQu√© beneficios tiene cada plan?",
            "keywords": ["beneficio", "incluye", "que viene"],
            "respuesta": "Cada plan incluye listado digital, analytics, y visibilidad. Los planes premium a√±aden featured status y m√°s categor√≠as.",
            "show_plans": True
        },
        {
            "id": "cancelar",
            "pregunta": "¬øPuedo cancelar en cualquier momento?",
            "keywords": ["cancelar", "devolucion", "dinero"],
            "respuesta": "Claro. Si no est√°s satisfecho en los primeros 30 d√≠as, devolvemos el 100% de tu dinero.",
            "follow_up": "¬øTe gustar√≠a comenzar con un plan?"
        }
    ],
    "en": [
        {
            "id": "precio",
            "pregunta": "What's the price?",
            "keywords": ["price", "cost", "how much"],
            "respuesta": "Our prices range from 19‚Ç¨/month (Basic Plan) to 199‚Ç¨/year (Annual Directory). All include satisfaction guarantee.",
            "planes_sugeridos": ["basico", "premium"]
        },
        {
            "id": "beneficios",
            "pregunta": "What are the benefits of each plan?",
            "keywords": ["benefit", "include", "what comes"],
            "respuesta": "Each plan includes digital listing, analytics, and visibility. Premium plans add featured status and more categories.",
            "show_plans": True
        },
        {
            "id": "cancelar",
            "pregunta": "Can I cancel anytime?",
            "keywords": ["cancel", "refund", "money"],
            "respuesta": "Yes. If you're not satisfied within 30 days, we refund 100% of your money.",
            "follow_up": "Would you like to start with a plan?"
        }
    ]
}

# ============================================================================
# FUNCIONES DE UTILIDAD
# ============================================================================

def get_plan(plan_id: str, language: str = "es") -> Optional[Dict]:
    """Obtener configuraci√≥n de un plan espec√≠fico."""
    plans = PLANS_CONFIG.get(language, PLANS_CONFIG["es"])
    for plan in plans:
        if plan["id"] == plan_id:
            return plan
    return None


def get_all_plans(language: str = "es") -> List[Dict]:
    """Obtener todos los planes."""
    return PLANS_CONFIG.get(language, PLANS_CONFIG["es"])


def get_categories(language: str = "es") -> List[Dict]:
    """Obtener todas las categor√≠as."""
    return CATEGORIES.get(language, CATEGORIES["es"])


def get_metric(metric_name: str, language: str = "es") -> any:
    """Obtener m√©trica espec√≠fica."""
    metrics = PLATFORM_METRICS.get(language, PLATFORM_METRICS["es"])
    return metrics.get(metric_name)


def get_faq_by_id(faq_id: str, language: str = "es") -> Optional[Dict]:
    """Obtener FAQ espec√≠fico."""
    faq_list = FAQ.get(language, FAQ["es"])
    for faq in faq_list:
        if faq["id"] == faq_id:
            return faq
    return None


def load_config_from_file(filepath: str) -> Dict:
    """
    Cargar configuraci√≥n desde archivo JSON.
    √ötil para cambiar configuraci√≥n sin editar c√≥digo.
    """
    try:
        with open(filepath, 'r', encoding='utf-8') as f:
            return json.load(f)
    except FileNotFoundError:
        print(f"Archivo de configuraci√≥n no encontrado: {filepath}")
        return {}
    except json.JSONDecodeError:
        print(f"Error al parsear JSON: {filepath}")
        return {}


def save_config_to_file(config: Dict, filepath: str):
    """Guardar configuraci√≥n a archivo JSON."""
    try:
        with open(filepath, 'w', encoding='utf-8') as f:
            json.dump(config, f, ensure_ascii=False, indent=2)
        print(f"Configuraci√≥n guardada en: {filepath}")
    except Exception as e:
        print(f"Error al guardar configuraci√≥n: {e}")


# ============================================================================
# EXPORTAR
# ============================================================================

if __name__ == "__main__":
    # Ejemplo de uso
    print("ü¶â Luna Bot Configuration")
    print("=" * 50)

    print("\nMascota:", MASCOT_CONFIG["name"], MASCOT_CONFIG["emoji"])

    print("\nPlanes disponibles (espa√±ol):")
    for plan in get_all_plans("es"):
        print(f"  - {plan['nombre']}: {plan['precio']}‚Ç¨/{plan['periodo']}")

    print("\nCategor√≠as:")
    for cat in get_categories("es"):
        print(f"  {cat['emoji']} {cat['nombre']}")

    print("\nTesrimonios:")
    for testimonial in TESTIMONIALS["es"]:
        print(f"  ‚≠ê {testimonial['nombre']} - {testimonial['negocio']}")
